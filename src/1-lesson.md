# Занятие №1

**Тема**  
Базовые понятия теории графов, свойства вершин и рёбер, матрица смежности, кодирование, условие Фано, представление кодировки в виде двоичного дерева.  
Задания ЕГЭ: 1, 4

Для первого занятия специально были выбраны задания, не требующие для решения доступа к компьютеру. Их так же объединяет использование базовых понятий теории графов и простой логики. Задания 1 и 4 рекомендуется решать на бумаге или, если вам так удобнее, в графическом редакторе (например, `Paint`).

## Задание №1

Во всех вариантах задания 1 вам предлагается сопоставить таблицу, в сущности являющейся матрицей смежности, и граф. Все задачи решаются последовательным сопоставлением вершин графа и строк таблицы с использованием их свойств.

### Определения

**Граф**[^1] — это топологическая модель, которая состоит из множества вершин и множества соединяющих их рёбер.  
**Инцидентность** — вершина и ребро называются инцидентными, если вершина является для этого ребра концевой.  
**Степень вершины** — это количество рёбер, инцидентных указанной вершине. По-другому — количество рёбер, исходящих из вершины.  
**Смежность вершин** — две вершины называются смежными, если они инцидентны одному ребру.  
**Взвешенный граф** — граф, в котором у каждого ребра и/или каждой вершины есть "вес" - некоторое число, которое может обозначать длину пути, его стоимость и т.п. В 1 задании ЕГЭ веса обычно относятся к рёбрам.  
**Длина пути** — количество рёбер в пути. Во взвешенном графе длина пути равна сумме весов рёбер, входящих в этот путь.  
**Кратные рёбра** — рёбра, имеющие одинаковые концевые вершины, по другому их называют ещё параллельными.  
**Ориентированный граф** — граф, в котором рёбра имеют направление.  
**Матрица смежности (весовая матрица)** — квадратная матрица $A = ||a_{ij}||$, где элемент $a_{ij}$ указывает на связь между вершинами $v_i$ и $v_j$. В невзвешенных графах, если вершины $v_i$ и $v_j$ смежны, то $a_{ij}$ равен `1`, в противном случае - `0`. В условиях задач матрица смежности часто представлена в виде таблицы, где `1` обозначается звездочкой, а `0` - пустой клеткой. В случае взвешенных графов, в таблице указываются веса рёбер. Если матрица смежности не симметрична относительно главной диагонали, это может означать, что граф ориентированный или содержит кратные ребра.

![](src/images/1-lesson/image2.jpg){ width=80% }

Матрица смежности однозначно задаёт граф, но может существовать несколько способов нарисовать его на плоскости. На картинке выше представлены два рисунка, соответствующие одной и той же матрице смежности.

[^1]: Подробнее о графах можете почитать на [Хабре](https://habr.com/ru/companies/otus/articles/568026/) [@otusgraphtheory] и в [вики-конспектах ИТМО](https://neerc.ifmo.ru/wiki/index.php?title=%D0%A2%D0%B5%D0%BE%D1%80%D0%B8%D1%8F_%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2) [@itmographtheory].

### Методика решения

Задание 1 всегда можно решить, итеративно находя вершину, для которой можно сказать:  
_"Это единственная вершина степени n, (не)смежная с ..."_  
Почти всегда задачу можно решить, применив более сложную логику на несколько шагов вперёд, но часто это приводит к ошибкам и лишним тратам времени.

Можно выделить несколько паттернов, часто встречающихся при решении задач:

1. Всегда сразу можно сопоставить уникальные вершины и строки
2. Если для вершины известны все соседи кроме одного, то он определяется методом исключения
3. Если известны все вершины данной степени кроме одной, то она определяется методом исключения
4. Если в графе известные вершины имеют общих соседей, то они определяются по таблице

Не всегда эти паттерны применимы, но они могут помочь вам решать задачи быстрее. Нередко попадаются симметричные графы, для которых установить взаимно однозначное соответствие между вершинами и строками таблицы невозможно. В таких случаях задача всегда будет составлена так, чтобы в этом не было необходимости или чтобы биекцию[^2] все-таки можно было установить, пользуясь дополнительными условиями. Во втором случае следует простым перебором попробовать все возможные варианты и выбрать удовлетворяющий всем условиям.

[^2]: Биекция — это отображение, устанавливающее взаимно однозначное соответствие между двумя множествами

### Варианты задания

- [Установить биекцию](#установить-биекцию)
- [Найти длину дороги](#найти-длину-дороги)
- [Найти пару (симметрия)](#найти-пару-симметрия)
- [Найти сумму протяжённостей](#найти-сумму-протяжённостей)
- [Прочие варианты задания 1](#прочие-варианты-задания-1)

#### Установить биекцию

На рисунке слева изображена схема дорог Н-ского района, в таблице звёздочкой обозначено наличие дороги из одного населённого пункта в другой. Отсутствие звёздочки означает, что такой дороги нет.

![](src/images/1-lesson/image19.jpg){ width=80% }

Каждому населённому пункту на схеме соответствует его номер в таблице, но неизвестно, какой именно номер. Выпишите последовательно, без пробелов и знаков препинания, указанные на графе буквенные обозначения пунктов от 1 до 7: сначала букву, соответствующую 1, затем букву, соответствующую 2, и т. д.  
_Ответ: CGADEBF_

**Алгоритм решения**

1. Выписать напротив каждой строки таблицы количество дорог
2. Посчитать степени вершин графа
3. Найти и сопоставить уникальные вершины
4. Пользуясь набором паттернов сопоставить все остальные пункты и вершины
5. Зная сопоставление таблицы и графа, выписать ответ

![](src/images/1-lesson/image13.jpg){ width=80% }

**Решение через паттерны**  
П2 - единственная строка с 2 звёздочками, G единственная вершина степени 2 $\Rightarrow$ G - П2  
Аналогично B - П6  
Для вершины G известны все соседи кроме одного $\Rightarrow$ C - П1  
Для вершины C известны все соседи кроме одного $\Rightarrow$ D - П4  
Из двух вершин степени 4 одна уже известна: D - П4 $\Rightarrow$ A - П3  
У вершин A и B два общих соседа: в графе это вершины F и D, а в таблице П7 и П4, причем известно, что D - П4 $\Rightarrow$ F - П7  
Аналогично E - П5  
**Решение через единственность**  
G - единственная вершина степени 2 $\Rightarrow$ G - П2  
B - единственная вершина степени 5 $\Rightarrow$ B - П6  
C - единственная вершина степени 3, смежная с П2 $\Rightarrow$ C - П1  
D - единственная вершина степени 4, смежная с П1 и П6 $\Rightarrow$ D - П4  
A - единственная вершина степени 4, смежная с П4 и П6 $\Rightarrow$ A - П3  
E - единственная вершина степени 3, смежная с П3 и П4 $\Rightarrow$ E - П5  
F - единственная вершина степени 3, смежная с П3, П5, П6 $\Rightarrow$ F - П7

#### Найти длину дороги

(4C771B) На рисунке справа схема дорог N-ского района изображена в виде графа, в таблице содержатся сведения о длинах этих дорог (в километрах).

![](src/images/1-lesson/image4.jpg){ width=80% }

Так как таблицу и схему рисовали независимо друг от друга, нумерация населённых пунктов в таблице никак
не связана с буквенными обозначениями на графе. Определите, какова длина дороги из пункта К в пункт Е.
В ответе запишите целое число – так, как оно указано в таблице.  
_Ответ: 10_

Такой вариант задачи часто можно решить, не устанавливая полное соответствие между таблицей и вершинами. Во время решения лучше обращать большее внимание на вершины, соседствующие с искомыми (в данном случае Е и К).

![](src/images/1-lesson/image14.jpg){ width=80% }

**Решение**  
Е - единственная вершина степени 4 $\Rightarrow$ E - П4  
Г - единственная вершина степени 3 $\Rightarrow$ Г - П2  
К - единственная вершина степени 2, смежная с П2 и П4 $\Rightarrow$ К - П1  
По таблице находим, что длина дороги из К в Е (из П1 в П4) равна 10. (Длина дороги из X в Y в таблице находится в клетке, стоящей на пересечении строки X и столбца Y)

Несмотря на то, что для решения задачи достаточно сопоставить только 3 вершины, для самопроверки можно определить остальные и убедиться, что всё сходится.

#### Найти пару (симметрия)

(A8DF4F) На рисунке изображена схема дорог N-ского района. В таблице звёздочкой обозначено наличие дороги из одного населённого пункта в другой. Отсутствие звёздочки означает, что такой дороги нет.

![](src/images/1-lesson/image11.jpg){ width=80% }

Каждому населённому пункту на схеме соответствует номер в таблице, но неизвестно, какой именно номер. Определите, какие номера в таблице могут соответствовать населённым пунктам C и E на схеме. В ответе запишите эти два номера
в возрастающем порядке без пробелов и знаков препинания.  
_Ответ: 15_

![](src/images/1-lesson/image9.jpg){ width=80% }

Помимо нового формата ответа, очень важной особенностью этого варианта задачи является симметрия. Граф симметричен и точно сопоставить вершины пунктам невозможно. Задача всегда будет составлена так, чтобы в случае симметрии либо не будет необходимости точно сопоставлять вершины строкам таблицы, либо чтобы это можно было сделать, пользуясь дополнительными условиями.

**Решение**  
D - единственная вершина степени 6 $\Rightarrow$ D - П3  
G и F единственные вершины степени 2 $\Rightarrow$ {G, F} - {П4, П6}, причем точно их сопоставить нельзя в силу симметрии. Чтобы решить задачу можно выбрать один из возможных вариантов, но впоследствии нужно убедиться, что он удовлетворяет всем условиям. Пусть G - П4, тогда F - П6. Избавившись таким образом от симметрии, можно точно сопоставить остальные вершины и пункты.  
A - единственная вершина степени 3, смежная с П3 и П4 $\Rightarrow$ A - П2  
B - единственная вершина степени 3, смежная с П3 и П6 $\Rightarrow$ B - П7  
C - единственная вершина степени 3, смежная с П3, П2 $\Rightarrow$ C - П1  
E - единственная вершина степени 3, смежная с П3, П7 $\Rightarrow$ E - П5  
Таким образом, номера, соответствующие населённым пунктам C и E на схеме, равны 1 и 5, и, записанные в возрастающем порядке без пробелов и знаков препинания, дают ответ 15.  
При решении был выбран вариант, в котором G - П4. Мы сопоставили все вершины и пункты, не встретив противоречий, и никаких дополнительных условий не было, значит этот вариант удовлетворяет всем условиям.
Задача специально составлена так, чтобы вне зависимости от выбора одного из возможных вариантов ответ был однозначно определен.

_Дальнейшие варианты задачи не требуют принципиально новых подходов к решению, достаточно комбинации уже разобранных_

#### Найти сумму протяжённостей

(656B8A) На рисунке схема дорог Н-ского района изображена в виде графа, в таблице содержатся сведения о протяжённости каждой из этих дорог (в километрах).

![](src/images/1-lesson/image6.jpg){ width=80% }

Так как таблицу и схему рисовали независимо друг от друга, то нумерация населённых пунктов в таблице никак
не связана с буквенными обозначениями на графе. Определите, какова сумма протяжённостей дорог из пункта F в пункт B и из пункта E в пункт C.
В ответе запишите целое число.  
_Ответ: 74_

![](src/images/1-lesson/image5.jpg){ width=80% }

**Решение**  
Эта задача несколько сложнее предыдущих, так как для решения нужно смотреть на шаг вперёд.  
F - единственная вершина степени 2, смежная с двумя вершинами степени 3. По таблице видим, что первая строка с двумя звёздочками - это П1. Она смежна с П2 и П7, но в строке П7 только две звёздочки $\Rightarrow$ П1 не подходит. Аналогично не подходит и П7. А вот П3, имея 2 звёздочки, смежна с П4 и П5, у которых по 3 звёздочки $\Rightarrow$ F - П3  
E - единственная вершина степени 2, имеющая общего соседа с F $\Rightarrow$ E - П7  
B - единственный общий сосед F и E $\Rightarrow$ B - П5  
С - оставшийся сосед E $\Rightarrow$ C - П1  
На этом можно остановиться, так как для решения задачи достаточно сопоставить только эти 4 вершины. Итак, длину дороги из F в B смотрим на 3 строке в 5 столбце, а из E в C - на 7 строке в 1 столбце. Полученные значения: 53 и 21, а их сумма 74.

#### Прочие варианты задания 1

Так же встречаются задачи, в которых нужно:

- Определить в какой пункт ведет самая короткая/длинная дорога из пункта Х
- Определить ближайший/самый удаленный пункт к пункту Х
- Найти длину кратчайшего пути
- Найти кратчайший путь (перечислить входящие в него вершины)

Для их решения достаточно применить те же методы, что и для решения предыдущих задач.

## Задание №4

В задании 4 вам предлагается определить кодировку, удовлетворяющую некоторым условиям.

### Определения

**Кодовое слово** — последовательность знаков. Обычно используются цифры, но несмотря на это, кодовое слово не является числом и может, например начинаться с нуля. В заданиях часто просят найти кодовое слово с минимальным/максимальным числовым значением: в этом случае подразумевается, что кодовые слова можно сравнивать как числа в соответствующей системе счисления, не обращая внимания на ведущие нули.  
Пример: `000`, `100111`, `123312`, `LKSD123`...  
**Двоичное кодирование** — это кодирование с помощью двух знаков. (обычно это цифры `0` и `1`)  
Пример: `000`, `100111`...  
**Равномерный код** — это код, в котором все кодовые слова имеют одинаковую длину.  
Пример:  
А - `000`  
Б - `101`  
В - `011`  
**Неравномерный код** — это код, в котором кодовые слова имеют различную длину.  
Пример:  
А - `0`  
Б - `101`  
В - `011`  
Г - `10`  
**Условие Фано**: для того, чтобы сообщение, записанное с помощью неравномерного по длине кода, однозначно декодировалось, достаточно, чтобы _никакой код не был началом другого (более длинного) кода_.  
Пример:  
А - `01`  
Б - `110`  
В - `0001`  
**Обратное условие Фано**: никакой код не является _окончанием_ другого (более длинного) кода.  
**Путь** или **Маршрут** — это последовательность смежных рёбер. Обычно путь задаётся перечислением вершин, по которым он пролегает.  
**Связный граф** — граф, в котором существует путь между любыми двумя вершинами.  
**Цепь** - маршрут без повторяющихся рёбер.  
**Цикл** — цепь, в котором последняя вершина совпадает с первой.  
**Дерево** — связный граф без циклов.  
**Бинарное (двоичное) дерево** — иерархическая структура данных, в которой каждый узел имеет не более двух потомков. Как правило, первый называется родительским узлом, а дети называются левым и правым наследниками.  
**Корень дерева** является единственным и не имеет родителей, а каждая другая вершина имеет одного родителя.

_Оказывается, что условие Фано соблюдается тогда и только тогда, когда кодировку можно представить в виде двоичного дерева._  
Чтобы визуализировать кодировку с помощью дерева нужно для каждого кодового слова построить путь от корня дерева к листу, где каждое ребро будет соответствовать одному символу кодового слова. В случае двоичного кодирования символ `0` соответствует левому потомку, а `1` - правому.

### Методика решения

У 4 задания есть несколько достаточно отличающихся друг от друга вариантов. Для решения наиболее часто встречающихся из них нужно построить двоичное дерево, соответствующее известной из условия части кодировки, а затем определить какое-нибудь его свойство или достроить недостающую его часть так, чтобы кодировка удовлетворяла некоторому условию. Более редкие варианты задачи, как правило, решаются простой логикой или перебором.

### Варианты задания

- [Найти минимальный код](#найти-минимальный-код)
- [Ловушка на внимательность](#ловушка-на-внимательность)
- [Найти наименьшую длину последовательности](#найти-наименьшую-длину-последовательности)
- [Логика](#логика)
- [Прочие варианты задания 4](#прочие-варианты-задания-4)

#### Найти минимальный код

\(501859) По каналу связи передаются шифрованные сообщения, содержащие только десять букв: А, Б, Е, И, К, Л, Р, С, Т, У. Для передачи используется неравномерный двоичный код. Для девяти букв используются кодовые слова.

| Буква | Кодовое слово | Буква | Кодовое слово |
| ----: | :------------ | ----: | :------------ |
|     А | 00            |     Л | 1001          |
|     Б | 1000          |     Р |               |
|     Е | 010           |     С | 1010          |
|     И | 011           |     Т | 1101          |
|     К | 1011          |     У | 111           |

Укажите кратчайшее кодовое слово для буквы Р, при котором код будет удовлетворять условию Фано. Если таких кодов несколько, укажите код с наименьшим числовым значением.  
Примечание. Условие Фано означает, что никакое кодовое слово не является началом другого кодового слова.
Это обеспечивает возможность однозначной расшифровки закодированных сообщений.  
_Ответ: 1100_

![_Чтобы было удобно рисовать двоичные деревья, рекомендую первое ветвление делать пошире, а каждую следующую ветвь делать в два раза короче предыдущей_](src/images/1-lesson/image16.jpg){ width=80% }

**Решение**  
_1 способ_  
Достаточно просто аккуратно нарисовать соответствующее кодировке двоичное дерево и заметить, что тупики везде, кроме узла 1100.  
_2 способ_  
Рисовать дерево для большого количества букв бывает долго. В таких случаях можно воспользоваться обычным перебором. Судя по условию, вряд ли искомое кодовое слово длиннее 4 символов, а значит в худшем случае мы переберём $2^4 + 2^3 + 2^2 + 2^1 = 31$ вариант, что не очень много.  
Перебираем все слова длины 1:  
0 - не подходит, так как с него начинается кодовое слово буквы А  
1 - не подходит, так как с него начинается кодовое слово буквы Б  
Длины 2:  
00 - не подходит из-за А  
01 - не подходит (Е)  
10 - нет (Б)  
11 - нет (Т)  
Длины 3:  
000 - нет (А)  
001 - нет (А)  
010 - нет (Е)  
011 - нет (И)  
100 - нет (Б)  
101 - нет (К)  
110 - нет (Т)  
111 - нет (У)  
Длины 4:  
0000, 0001, 0010, 0011 - нет (А)  
0100, 0101 - нет (Е)  
0110, 0111 - нет (И)  
1000 - нет (Б)  
1001 - нет (Л)  
1010 - нет (С)  
1011 - нет (К)  
1100 - подходит!  
1100 будет ответом, потому что мы перебрали все кодовые слова меньшей длины и они не подошли, а поскольку мы перебирали кодовые слова одной длины в возрастающем порядке, то 1100 наименьшее из подходящих.

#### Ловушка на внимательность

Все заглавные буквы русского алфавита закодированы неравномерным двоичным кодом, в котором никакое кодовое слово не является началом другого кодового слова. Это условие обеспечивает возможность однозначной расшифровки закодированных сообщений. Кодовые слова для некоторых букв известны: А – 010, Б - 011, В - 10, Г - 110, Д - 111. Укажите возможный код минимальной длины для буквы З. Если таких кодов несколько, укажите тот из них, который имеет минимальное числовое значение.  
_Ответ: 000_

![](src/images/1-lesson/image3.jpg){ width=80% }

Эта задача похожа на предыдущую, но она ловит тех, кто не обратил внимание на дополнительное условие.

**Решение**  
Записываем известную часть кодировки в виде двоичного дерева и замечаем, что тупики везде, кроме узла 00. Возникает желание сопоставить "З" код 00, но это ошибка. Если так сделать, то приткнуть весь остальной алфавит будет некуда, а в условии специально обозначено, что закодированы все буквы русского алфавита. Приходится в 00 делать еще одну развилку. В левого потомка поместим "З" чтобы код имел наименьшее числовое значение, а от правого пойдет весь остальной алфавит. Получаем для "З" кодовое слово 000

#### Найти наименьшую длину последовательности

По каналу связи передаются сообщения, содержащие только шесть букв: К, Л, А, Д, О, В. Для передачи используется неравномерный двоичный код, удовлетворяющий условию Фано. Буквы Д и О имеют коды 0 и 11 соответственно. Укажите наименьшую возможную длину закодированной последовательности для слова КЛАДОВКА.  
_Ответ: 27_

![](src/images/1-lesson/image15.jpg){ width=80% }

**Решение**  
Чтобы минимизировать длину закодированной последовательности нужно наиболее часто встречающимся буквам сопоставить как можно более короткие кодовые слова.
Буквы К и А встречаются дважды, а все остальные буквы единожды, так что постараемся при построении дерева сопоставить им коды покороче. Чтобы этого добиться, при построении дерева надо пользоваться принципом:  
_"если есть возможность выделить короткий код для наиболее часто встречающейся буквы, то ей надо воспользоваться"._  
Построив дерево, считаем длины кодовых слов каждой буквы и их сумму чтобы посчитать длину закодированной последовательности. Получаем ответ 27.  
В качестве проверки в задачах такого типа можно попробовать построить дерево как-нибудь иначе и убедиться, что длина закодированной последовательности останется такой же или увеличится.

#### Логика

Заглавные буквы русского алфавита закодированы неравномерным двоичным кодом, в котором никакое кодовое слово не является началом другого кодового слова. Это условие обеспечивает возможность однозначной расшифровки закодированных сообщений. Известно, что все кодовые слова содержат не меньше двух и не больше трёх двоичных знаков, а слову МЕТОД соответствует код 11000111110011. Какой код соответствует слову ДОМ?  
_Ответ: 01110110_

![](src/images/1-lesson/image12.jpg){ width=50% }

**Решение**  
Чтобы решить такую задачу вообще ничего знать не надо, достаточно руководствоваться простой логикой.
Выписываем закодированную последовательность и пытаемся вытащить из нее нужные нам буквы.  
Буква М в слове МЕТОД стоит первой и из условия известно, что длина всех кодовых слов 2 или 3 $\Rightarrow$ кодовое слово буквы М - 11 или 110.
11 оно быть не может, потому что в середине есть 5 единиц подряд, а значит как минимум еще одно кодовое слово будет начинаться с 11 $\Rightarrow$ М - 110.  
Буква Д стоит последней. По тем же соображениям её кодовое слово 11 или 011, причём 11 не подходит $\Rightarrow$ Д - 011.  
Буква О стоит перед Д, а значит её кодовое слово 10 или 110. 110 не подходит, потому что оно совпадает с кодовым словом буквы М $\Rightarrow$ О - 10.  
Получаем закодированную последовательность слова ДОМ: 01110110

#### Прочие варианты задания 4

Так же встречаются задачи, в которых нужно:

- Найти кодовое слово для буквы с максимальным числовым значением
- Наименьшую суммарную длину кодовых слов всех букв
- Найти закодированную последовательность
- Найти закодированную последовательность в 8/16-ричной системе счисления
- В задачах на логику можно встретить использование равномерного кода
